<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mesh Network - TrueVault VPN</title>
    <link rel="icon" type="image/svg+xml" href="/assets/images/favicon.svg">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style id="theme-variables">:root{--colors-primary:#00d9ff;--colors-secondary:#00ff88;--colors-accent:#ff6b6b;--colors-background:#0f0f1a;--colors-background-secondary:#1a1a2e;--colors-text:#ffffff;--colors-text-muted:#888888;--colors-success:#00ff88;--colors-warning:#ffbb00;--colors-error:#ff5050;--gradients-primary:linear-gradient(90deg,#00d9ff,#00ff88);--gradients-background:linear-gradient(135deg,#0f0f1a,#1a1a2e);--buttons-border-radius:8px;--cards-border-radius:14px;--colors-border:rgba(255,255,255,0.08);--layout-sidebar-width:260px;}</style>
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/dashboard.css">
    <style>
        .mesh-intro{background:linear-gradient(135deg,rgba(138,43,226,0.15),rgba(0,217,255,0.1));border:1px solid rgba(138,43,226,0.3);border-radius:var(--cards-border-radius);padding:30px;margin-bottom:30px}
        .mesh-intro h2{margin-bottom:10px;color:#9b59b6}
        .mesh-visual{position:relative;height:300px;background:rgba(0,0,0,0.2);border-radius:var(--cards-border-radius);margin-bottom:30px;overflow:hidden}
        .mesh-node{position:absolute;width:80px;height:80px;background:rgba(255,255,255,0.05);border:2px solid var(--colors-border);border-radius:50%;display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:all 0.2s}
        .mesh-node:hover{border-color:var(--colors-primary);transform:scale(1.1)}
        .mesh-node.active{border-color:var(--colors-success);background:rgba(0,255,136,0.1)}
        .mesh-node.you{border-color:var(--colors-primary);background:rgba(0,217,255,0.1)}
        .mesh-node .icon{font-size:1.5rem}
        .mesh-node .name{font-size:0.7rem;margin-top:5px;text-align:center}
        .mesh-line{position:absolute;height:2px;background:linear-gradient(90deg,rgba(0,217,255,0.3),rgba(138,43,226,0.3));transform-origin:left center}
        .members-section{margin-bottom:30px}
        .members-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:15px;margin-top:15px}
        .member-card{background:rgba(255,255,255,0.03);border:1px solid var(--colors-border);border-radius:var(--cards-border-radius);padding:20px;display:flex;align-items:center;gap:15px}
        .member-card.pending{border-style:dashed;opacity:0.7}
        .member-avatar{width:50px;height:50px;border-radius:50%;background:linear-gradient(135deg,#9b59b6,#00d9ff);display:flex;align-items:center;justify-content:center;font-size:1.5rem}
        .member-info{flex:1}
        .member-info h4{margin-bottom:3px}
        .member-info .email{font-size:0.85rem;color:var(--colors-text-muted)}
        .member-info .status{font-size:0.8rem;margin-top:5px}
        .shared-resources{margin-top:30px}
        .resource-card{background:rgba(255,255,255,0.03);border:1px solid var(--colors-border);border-radius:12px;padding:20px;display:flex;align-items:center;gap:15px;margin-bottom:10px}
        .resource-icon{font-size:2rem}
        .resource-info h4{margin-bottom:3px}
        .resource-info p{font-size:0.85rem;color:var(--colors-text-muted)}
        .invite-section{background:rgba(138,43,226,0.1);border:1px solid rgba(138,43,226,0.3);border-radius:var(--cards-border-radius);padding:25px;margin-top:30px}
        .invite-form{display:flex;gap:10px;margin-top:15px}
        .invite-form input{flex:1}
        .modal{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.8);display:flex;align-items:center;justify-content:center;z-index:1000;opacity:0;visibility:hidden;transition:all 0.3s}
        .modal.active{opacity:1;visibility:visible}
        .modal-content{background:var(--colors-background-secondary);border:1px solid var(--colors-border);border-radius:var(--cards-border-radius);padding:30px;width:100%;max-width:500px}
        .modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:25px}
        .modal-close{background:none;border:none;color:var(--colors-text-muted);font-size:1.5rem;cursor:pointer}
    </style>
</head>
<body class="dashboard-body">
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header"><span class="logo-icon">ğŸ›¡ï¸</span><h1>TrueVault</h1></div>
        <nav class="sidebar-nav">
            <a href="/dashboard/" class="nav-item"><span class="nav-icon">ğŸ“Š</span><span>Overview</span></a>
            <a href="/dashboard/connect.html" class="nav-item"><span class="nav-icon">ğŸ”Œ</span><span>Connect</span></a>
            <a href="/dashboard/servers.html" class="nav-item"><span class="nav-icon">ğŸŒ</span><span>Servers</span></a>
            <a href="/dashboard/identities.html" class="nav-item"><span class="nav-icon">ğŸ­</span><span>Identities</span></a>
            <a href="/dashboard/certificates.html" class="nav-item"><span class="nav-icon">ğŸ“œ</span><span>Certificates</span></a>
            <a href="/dashboard/devices.html" class="nav-item"><span class="nav-icon">ğŸ“±</span><span>Devices</span></a>
            <a href="/dashboard/cameras.html" class="nav-item"><span class="nav-icon">ğŸ“·</span><span>Cameras</span></a>
            <a href="/dashboard/mesh.html" class="nav-item active"><span class="nav-icon">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</span><span>Mesh Network</span></a>
            <div class="nav-divider"></div>
            <a href="/dashboard/scanner.html" class="nav-item"><span class="nav-icon">ğŸ”</span><span>Network Scanner</span></a>
            <a href="/dashboard/settings.html" class="nav-item"><span class="nav-icon">âš™ï¸</span><span>Settings</span></a>
            <a href="/dashboard/billing.html" class="nav-item"><span class="nav-icon">ğŸ’³</span><span>Billing</span></a>
        </nav>
        <div class="sidebar-footer">
            <div class="user-info"><div class="user-avatar">ğŸ‘¤</div><div class="user-details"><span class="user-name" id="userName">Loading...</span><span class="user-plan" id="userPlan">-</span></div></div>
            <button class="btn btn-secondary btn-small" onclick="TrueVault.Auth.logout()">Logout</button>
        </div>
    </aside>
    
    <main class="main-content">
        <header class="dashboard-header">
            <div>
                <h1>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Family Mesh Network</h1>
                <p class="text-muted">Connect devices across locations as if they're on the same network</p>
            </div>
            <div class="header-actions">
                <button class="btn btn-primary" onclick="showInviteModal()">â• Invite Member</button>
            </div>
        </header>
        
        <!-- Intro -->
        <div class="mesh-intro">
            <h2>ğŸ”— Your Private Overlay Network</h2>
            <p class="text-muted">Connect all your devices and trusted family members as if they're on the same local network â€” regardless of physical location. Share printers, access cameras, transfer files, and more without complex port forwarding.</p>
        </div>
        
        <!-- Visual Mesh -->
        <div class="mesh-visual" id="meshVisual">
            <!-- Center node (You) -->
            <div class="mesh-node you" style="left:50%;top:50%;transform:translate(-50%,-50%)">
                <span class="icon">ğŸ‘¤</span>
                <span class="name">You</span>
            </div>
            <!-- Family members -->
            <div class="mesh-node active" style="left:20%;top:30%">
                <span class="icon">ğŸ‘©</span>
                <span class="name">Sarah</span>
            </div>
            <div class="mesh-node active" style="left:75%;top:25%">
                <span class="icon">ğŸ‘¦</span>
                <span class="name">Mike</span>
            </div>
            <div class="mesh-node" style="left:80%;top:70%">
                <span class="icon">ğŸ–¨ï¸</span>
                <span class="name">Printer</span>
            </div>
            <div class="mesh-node" style="left:15%;top:70%">
                <span class="icon">ğŸ“·</span>
                <span class="name">Camera</span>
            </div>
        </div>
        
        <!-- Members -->
        <div class="members-section">
            <h3>ğŸ‘¥ Network Members (<span id="memberCount">3</span>)</h3>
            <div class="members-grid">
                <div class="member-card">
                    <div class="member-avatar">ğŸ‘¤</div>
                    <div class="member-info">
                        <h4>You (Owner)</h4>
                        <div class="email">john@example.com</div>
                        <div class="status"><span class="badge badge-success">Online</span></div>
                    </div>
                </div>
                
                <div class="member-card">
                    <div class="member-avatar">ğŸ‘©</div>
                    <div class="member-info">
                        <h4>Sarah</h4>
                        <div class="email">sarah@example.com</div>
                        <div class="status"><span class="badge badge-success">Online</span> â€¢ 3 devices</div>
                    </div>
                    <button class="btn btn-secondary btn-small" onclick="manageMember(1)">âš™ï¸</button>
                </div>
                
                <div class="member-card">
                    <div class="member-avatar">ğŸ‘¦</div>
                    <div class="member-info">
                        <h4>Mike</h4>
                        <div class="email">mike@example.com</div>
                        <div class="status"><span class="badge badge-info">Away</span> â€¢ 2 devices</div>
                    </div>
                    <button class="btn btn-secondary btn-small" onclick="manageMember(2)">âš™ï¸</button>
                </div>
                
                <div class="member-card pending">
                    <div class="member-avatar">ğŸ“§</div>
                    <div class="member-info">
                        <h4>Pending Invite</h4>
                        <div class="email">grandma@example.com</div>
                        <div class="status"><span class="badge badge-warning">Pending</span></div>
                    </div>
                    <button class="btn btn-secondary btn-small" onclick="resendInvite()">ğŸ”„</button>
                </div>
            </div>
        </div>
        
        <!-- Shared Resources -->
        <div class="shared-resources">
            <h3>ğŸ“‚ Shared Resources</h3>
            <div class="resource-card">
                <span class="resource-icon">ğŸ–¨ï¸</span>
                <div class="resource-info">
                    <h4>HP LaserJet Pro</h4>
                    <p>Shared by You â€¢ Available to all members</p>
                </div>
                <button class="btn btn-secondary btn-small" onclick="manageResource(1)">âš™ï¸</button>
            </div>
            <div class="resource-card">
                <span class="resource-icon">ğŸ“·</span>
                <div class="resource-info">
                    <h4>Front Door Camera</h4>
                    <p>Shared by You â€¢ View only</p>
                </div>
                <button class="btn btn-secondary btn-small" onclick="manageResource(2)">âš™ï¸</button>
            </div>
            <div class="resource-card">
                <span class="resource-icon">ğŸ“</span>
                <div class="resource-info">
                    <h4>Family Photos NAS</h4>
                    <p>Shared by Sarah â€¢ Full access</p>
                </div>
                <button class="btn btn-secondary btn-small" onclick="manageResource(3)">âš™ï¸</button>
            </div>
        </div>
        
        <!-- Invite Section -->
        <div class="invite-section">
            <h3>ğŸ“¨ Invite Family Members</h3>
            <p class="text-muted">Members you invite can connect to your mesh network and access shared resources.</p>
            <div class="invite-form">
                <input type="email" id="inviteEmail" placeholder="Enter email address">
                <button class="btn btn-primary" onclick="sendInvite()">Send Invite</button>
            </div>
        </div>
    </main>
    
    <!-- Invite Modal -->
    <div class="modal" id="inviteModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>â• Invite to Mesh Network</h2>
                <button class="modal-close" onclick="hideModal()">&times;</button>
            </div>
            <form id="inviteForm">
                <div class="form-group">
                    <label>Email Address *</label>
                    <input type="email" name="email" placeholder="family@example.com" required>
                </div>
                <div class="form-group">
                    <label>Nickname</label>
                    <input type="text" name="nickname" placeholder="e.g., Mom, Dad, Kids">
                </div>
                <div class="form-group">
                    <label>Permissions</label>
                    <select name="permissions">
                        <option value="full">Full Access - Can share resources</option>
                        <option value="limited">Limited - Can only view shared resources</option>
                        <option value="readonly">Read Only - View only, no changes</option>
                    </select>
                </div>
                <div style="display:flex;gap:10px;margin-top:25px">
                    <button type="button" class="btn btn-secondary" onclick="hideModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary" style="flex:1">ğŸ“¨ Send Invitation</button>
                </div>
            </form>
        </div>
    </div>
    
    <script src="/assets/js/theme-loader.js"></script>
    <script src="/assets/js/app.js"></script>
    <script>
        if (!TrueVault.Auth.requireAuth()) {}
        
        const user = TrueVault.Auth.getUser();
        if (user) {
            document.getElementById('userName').textContent = user.first_name + ' ' + user.last_name;
            document.getElementById('userPlan').textContent = user.plan_type.charAt(0).toUpperCase() + user.plan_type.slice(1) + ' Plan';
        }
        
        function showInviteModal() {
            document.getElementById('inviteModal').classList.add('active');
        }
        
        function hideModal() {
            document.getElementById('inviteModal').classList.remove('active');
        }
        
        document.getElementById('inviteForm').addEventListener('submit', function(e) {
            e.preventDefault();
            TrueVault.Toast.success('Invitation sent!');
            hideModal();
            this.reset();
        });
        
        function sendInvite() {
            const email = document.getElementById('inviteEmail').value;
            if (!email) {
                TrueVault.Toast.error('Please enter an email');
                return;
            }
            TrueVault.Toast.success('Invitation sent to ' + email);
            document.getElementById('inviteEmail').value = '';
        }
        
        function manageMember(id) {
            TrueVault.Toast.info('Member management coming soon');
        }
        
        function manageResource(id) {
            TrueVault.Toast.info('Resource management coming soon');
        }
        
        function resendInvite() {
            TrueVault.Toast.success('Invitation resent!');
        }
        
        document.getElementById('inviteModal').addEventListener('click', function(e) {
            if (e.target === this) hideModal();
        });
    </script>
</body>
</html>
